!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).mdsdk=t()}(this,function(){"use strict";function t(){return((new Date).getTime()/1e3).toFixed(0)}return{params:{},data:{serverUrl:"",EVENT_PREFIX:"longan-"},setData:function(e){this.data=Object.assign({},this.data,e)},init:function(){document&&(this.params.domain=document.domain||"",this.params.url=document.URL||"",this.params.title=document.title||"",this.params.referrer=document.referrer||""),window&&window.screen&&(this.params.sh=window.screen.height||0,this.params.sw=window.screen.width||0,this.params.cd=window.screen.colorDepth||0,this.params.origin=window.location.origin,this.params.pathname=window.location.pathname),navigator&&(this.params.lang=navigator.language||""),document.addEventListener("visibilitychange",function(){console.log(document.visibilityState)}),this.listenTriggerEvent(this.params),this.listenHistory(this.params)},sendRequest:function(e){e.route=window.location.origin+window.location.pathname,e.createTime=((new Date).getTime()/1e3).toFixed(0),(new Image).src=data.serverUrl+"?"+function(){var e,t="";for(e in params)""!=t&&(t+="&"),t+=e+"="+params[e];return t}(params)},listenTriggerEvent:function(i){var a=this.data.EVENT_PREFIX;document.addEventListener("click",function(e){var t,n=e.target.dataset;e.target.id&&e.target.id.startsWith(a)&&(t=e.target.id.split(a)[1],e=e.target.innerHTML||"",t=Object.assign(i,n,{type:"event-click",client:navigator.userAgent,content:e,name:t}),console.log(t))})},listenHistory:function(e){window.onload=function(){e.createTime=t(),e.type="进入页面",console.log("onload",e)},window.onbeforeunload=function(){e.leaveTime=t(),console.log(e),e.type="离开页面",localStorage.setItem("onbeforeunload",e),alert("oo")}}}});
